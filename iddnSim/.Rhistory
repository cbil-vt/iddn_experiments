devtools::load_all(".")
source("E:/OneDrive - Virginia Tech/x_code/ddn/experiment_iddn_R/iddnSim/example/sim_jgl.R")
devtools::load_all(".")
source("E:/OneDrive - Virginia Tech/x_code/ddn/experiment_iddn_R/iddnSim/example/sim_jgl.R")
source("E:/OneDrive - Virginia Tech/x_code/ddn/experiment_iddn_R/iddnSim/example/sim_jgl.R")
source("E:/OneDrive - Virginia Tech/x_code/ddn/experiment_iddn_R/iddnSim/example/sim_jgl.R")
source("E:/OneDrive - Virginia Tech/x_code/ddn/experiment_iddn_R/iddnSim/example/sim_jgl.R")
source("E:/OneDrive - Virginia Tech/x_code/ddn/experiment_iddn_R/iddnSim/example/sim_jgl.R")
stopCluster(cl)
devtools::load_all(".")
source("E:/OneDrive - Virginia Tech/x_code/ddn/experiment_iddn_R/iddnSim/example/sim_jgl.R")
source("E:/OneDrive - Virginia Tech/x_code/ddn/experiment_iddn_R/iddnSim/example/sim_jgl.R")
source("E:/OneDrive - Virginia Tech/x_code/ddn/experiment_iddn_R/iddnSim/example/sim_jgl.R")
fname = paste("../sim_output/", sim_name, "_jgl_sample_", n_sample_work,
"_sigma_", sprintf("%.1f",sigma_add), ".hdf5", sep = "")
h5createFile(fname)
h5write(dep_est_arr, fname, "dep_est")
devtools::load_all(".")
source("E:/OneDrive - Virginia Tech/x_code/ddn/experiment_iddn_R/iddnSim/example/sim_jgl.R")
source("E:/OneDrive - Virginia Tech/x_code/ddn/experiment_iddn_R/iddnSim/example/sim_jgl.R")
dep_est_arr
devtools::load_all(".")
source("E:/OneDrive - Virginia Tech/x_code/ddn/experiment_iddn_R/iddnSim/example/sim_jgl.R")
devtools::load_all(".")
source("E:/OneDrive - Virginia Tech/x_code/ddn/experiment_iddn_R/iddnSim/example/sim_jgl.R")
library(rhdf5)
library(parallel)
library(JGLtry)
sim_data_folder <- "../../experiment_iddn_paper/sim_input/"
sim_name = "sim3_tf_mrna_n-hub_2_n-node_144_hill_1.0_sigma_bi_2_1_2_odd_even_ratio_0.25_n_10000_941067"
n_rep = 32
n_sample_work = 200  # 100
sigma_add = 0.0  # 2.0
l1_rg = seq(0.02, 0.8, by = 0.02)
l2_rg = seq(0.0, 0.2, by = 0.02)
devtools::load_all(".")
devtools::load_all(".")
library(rhdf5)
library(parallel)
library(JGLtry)
source("E:/OneDrive - Virginia Tech/x_code/ddn/experiment_iddn_R/iddnSim/example/sim_jgl.R")
devtools::load_all(".")
devtools::load_all(".")
source("E:/OneDrive - Virginia Tech/x_code/ddn/experiment_iddn_R/iddnSim/example/sim_jgl.R")
source("E:/OneDrive - Virginia Tech/x_code/ddn/experiment_iddn_R/iddnSim/example/sim_jgl.R")
devtools::load_all(".")
source("E:/OneDrive - Virginia Tech/x_code/ddn/experiment_iddn_R/iddnSim/example/sim_jgl.R")
source("E:/OneDrive - Virginia Tech/x_code/ddn/experiment_iddn_R/iddnSim/example/sim_jgl.R")
source("E:/OneDrive - Virginia Tech/x_code/ddn/experiment_iddn_R/iddnSim/example/sim_jgl.R")
source("E:/OneDrive - Virginia Tech/x_code/ddn/experiment_iddn_R/iddnSim/example/sim_jgl.R")
source("E:/OneDrive - Virginia Tech/x_code/ddn/experiment_iddn_R/iddnSim/example/sim_jgl.R")
source("E:/OneDrive - Virginia Tech/x_code/ddn/experiment_iddn_R/iddnSim/example/sim_jgl.R")
source("E:/OneDrive - Virginia Tech/x_code/ddn/experiment_iddn_R/iddnSim/example/sim_jgl.R")
devtools::load_all(".")
source("E:/OneDrive - Virginia Tech/x_code/ddn/experiment_iddn_R/iddnSim/example/sim_jgl.R")
source("E:/OneDrive - Virginia Tech/x_code/ddn/experiment_iddn_R/iddnSim/example/sim_jgl.R")
source("E:/OneDrive - Virginia Tech/x_code/ddn/experiment_iddn_R/iddnSim/example/sim_jgl.R")
source("E:/OneDrive - Virginia Tech/x_code/ddn/experiment_iddn_R/iddnSim/example/sim_jgl.R")
devtools::load_all(".")
source("E:/OneDrive - Virginia Tech/x_code/ddn/experiment_iddn_R/iddnSim/example/sim_jgl.R")
source("E:/OneDrive - Virginia Tech/x_code/ddn/experiment_iddn_R/iddnSim/example/sim_jgl.R")
source("E:/OneDrive - Virginia Tech/x_code/ddn/experiment_iddn_R/iddnSim/example/sim_jgl.R")
source("E:/OneDrive - Virginia Tech/x_code/ddn/experiment_iddn_R/iddnSim/example/sim_jgl.R")
devtools::load_all(".")
source("E:/OneDrive - Virginia Tech/x_code/ddn/experiment_iddn_R/iddnSim/example/sim_jgl.R")
source("E:/OneDrive - Virginia Tech/x_code/ddn/experiment_iddn_R/iddnSim/example/sim_jgl.R")
devtools::load_all(".")
source("E:/OneDrive - Virginia Tech/x_code/ddn/experiment_iddn_R/iddnSim/example/sim_jgl.R")
devtools::load_all(".")
source("E:/OneDrive - Virginia Tech/x_code/ddn/experiment_iddn_R/iddnSim/example/sim_jgl.R")
source("E:/OneDrive - Virginia Tech/x_code/ddn/experiment_iddn_R/iddnSim/example/sim_jgl.R")
devtools::load_all(".")
source("E:/OneDrive - Virginia Tech/x_code/ddn/experiment_iddn_R/iddnSim/example/sim_jgl.R")
source("E:/OneDrive - Virginia Tech/x_code/ddn/experiment_iddn_R/iddnSim/example/sim_jgl.R")
source("E:/OneDrive - Virginia Tech/x_code/ddn/experiment_iddn_R/iddnSim/example/sim_jgl.R")
source("E:/OneDrive - Virginia Tech/x_code/ddn/experiment_iddn_R/iddnSim/example/sim_jgl.R")
source("E:/OneDrive - Virginia Tech/x_code/ddn/experiment_iddn_R/iddnSim/example/sim_jgl.R")
source("E:/OneDrive - Virginia Tech/x_code/ddn/experiment_iddn_R/iddnSim/example/sim_jgl.R")
source("E:/OneDrive - Virginia Tech/x_code/ddn/experiment_iddn_R/iddnSim/example/sim_jgl.R")
source("E:/OneDrive - Virginia Tech/x_code/ddn/experiment_iddn_R/iddnSim/example/sim_jgl.R")
source("E:/OneDrive - Virginia Tech/x_code/ddn/experiment_iddn_R/iddnSim/example/sim_jgl.R")
devtools::load_all(".")
# run iDINGO ----
library(iDINGO)
library(rhdf5)
library(parallel)
sim_data_folder <- "../../experiment_iddn_paper/sim_input/"
exp_name = "sim3_ggm_four_layer_batch_987306"
n_rep = 5
n_sample_work = 200  # 100
sigma_add = 0.0  # 0
# R and Python HDF5 packages use opposite dimension orders
sim_filename = paste(sim_data_folder, exp_name, ".hdf5", sep = "")
print(h5ls(sim_filename))
dat1_lst = t(h5read(sim_filename, "dat1"))
dat1_lst = h5read(sim_filename, "dat1")
dat2_lst = h5read(sim_filename, "dat2")
dat1_lst <- aperm(dat1_lst, c(3,2,1))
dat2_lst <- aperm(dat2_lst, c(3,2,1))
layer_count = h5read(sim_filename, "layer_count")
layer_count
n_layer = sum(layer_count>0)
n1 = layer_count[1]  # TF proteins
n2 = layer_count[2]  # mRNAs
n3 = layer_count[3]  # miRNAs and lncRNAs
dat1 = dat1_lst[1,,]
n_sample = dim(dat1)[1]
n_feature = dim(dat1)[2]
plats = c("miRNA", "mRNA", "Protein")
diffscore_mat_all = array(0.0, c(n_rep, n_feature, n_feature))
n=1
# Must scale data first
dat1 = dat1_lst[n,,]
dat2 = dat2_lst[n,,]
dat1_sel = dat1[1:n_sample_work, 1:n_feature]
dat2_sel = dat2[1:n_sample_work, 1:n_feature]
dat_class = c(rep(0,n_sample_work), rep(1,n_sample_work))
dat12_sel = rbind(dat1_sel, dat2_sel)
# The dataset has order mRNA, protein, and miRNA
dat_tf = dat12_sel[,1:n1]
dat_mRNA = dat12_sel[,(n1+1):(n1+n2)]
dat_miRNA = dat12_sel[,(n1+n2+1):(n1+n2+n3)]
colnames(dat_protein) = paste0("mol_", 1:n1)
# The dataset has order mRNA, protein, and miRNA
dat_protein = dat12_sel[,1:n1]
dat_mRNA = dat12_sel[,(n1+1):(n1+n2)]
dat_miRNA = dat12_sel[,(n1+n2+1):(n1+n2+n3)]
colnames(dat_protein) = paste0("mol_", 1:n1)
colnames(dat_mRNA) = paste0("mol_", (n1+1):(n1+n2))
colnames(dat_miRNA) = paste0("mol_", (n1+n2+1):(n1+n2+n3))
source("E:/OneDrive - Virginia Tech/x_code/ddn/experiment_iddn_R/iddnSim/example/sim_idingo_four_layer.R")
fname = paste("../sim_output/", exp_name, "_idingo_sample_", n_sample_work,
"_sigma_", sprintf("%.1f",sigma_add), "_4_layer.hdf5", sep = "")
h5createFile(fname)
h5write(diffscore_mat_all, fname, "diffscore")
source("E:/OneDrive - Virginia Tech/x_code/ddn/experiment_iddn_R/iddnSim/example/sim_idingo_four_layer.R")
devtools::load_all(".")
source("E:/OneDrive - Virginia Tech/x_code/ddn/experiment_iddn_R/iddnSim/example/sim_jgl.R")
source("E:/OneDrive - Virginia Tech/x_code/ddn/experiment_iddn_R/iddnSim/example/sim_idingo_three_layer_as_two.R")
dim(dat1_lst)
n_feature
source("E:/OneDrive - Virginia Tech/x_code/ddn/experiment_iddn_R/iddnSim/example/sim_idingo_three_layer_as_two.R")
mol1
n1
colnames(dat_mRNA)
source("E:/OneDrive - Virginia Tech/x_code/ddn/experiment_iddn_R/iddnSim/example/sim_idingo_three_layer_as_two.R")
source("E:/OneDrive - Virginia Tech/x_code/ddn/experiment_iddn_R/iddnSim/example/sim_jgl.R")
source("E:/OneDrive - Virginia Tech/x_code/ddn/experiment_iddn_R/iddnSim/example/sim_jgl.R")
source("E:/OneDrive - Virginia Tech/x_code/ddn/experiment_iddn_R/iddnSim/example/sim_jgl.R")
source("E:/OneDrive - Virginia Tech/x_code/ddn/experiment_iddn_R/iddnSim/example/sim_idingo_three_layer_as_two.R")
source("E:/OneDrive - Virginia Tech/x_code/ddn/experiment_iddn_R/iddnSim/example/sim_idingo_three_layer_as_two.R")
devtools::load_all(".")
source("E:/OneDrive - Virginia Tech/x_code/ddn/experiment_iddn_R/iddnSim/example/sim_jgl.R")
}
devtools::load_all(".")
source("E:/OneDrive - Virginia Tech/x_code/ddn/experiment_iddn_R/iddnSim/example/sim_idingo_three_layer_as_two.R")
warnings()
devtools::load_all(".")
source("E:/OneDrive - Virginia Tech/x_code/ddn/experiment_iddn_R/iddnSim/example/sim_idingo_three_layer_as_two.R")
devtools::load_all(".")
source("E:/OneDrive - Virginia Tech/x_code/ddn/experiment_iddn_R/iddnSim/example/sim_idingo_three_layer_as_two.R")
devtools::load_all(".")
source("E:/OneDrive - Virginia Tech/x_code/ddn/experiment_iddn_R/iddnSim/example/sim_jgl.R")
source("E:/OneDrive - Virginia Tech/x_code/ddn/experiment_iddn_R/iddnSim/example/sim_idingo_three_layer_as_two.R")
source("E:/OneDrive - Virginia Tech/x_code/ddn/experiment_iddn_R/iddnSim/example/sim_jgl.R")
source("E:/OneDrive - Virginia Tech/x_code/ddn/experiment_iddn_R/iddnSim/example/sim_idingo_three_layer_as_two.R")
devtools::load_all(".")
source("E:/OneDrive - Virginia Tech/x_code/ddn/experiment_iddn_R/iddnSim/example/sim_jgl_speed_sample.R")
source("E:/OneDrive - Virginia Tech/x_code/ddn/experiment_iddn_R/iddnSim/example/sim_jgl_speed_sample.R")
devtools::load_all(".")
source("E:/OneDrive - Virginia Tech/x_code/ddn/experiment_iddn_R/iddnSim/example/sim_jgl_speed_sample.R")
source("E:/OneDrive - Virginia Tech/x_code/ddn/experiment_iddn_R/iddnSim/example/sim_jgl_speed_sample.R")
dim(dat1)
i
n
n_sample_work
source("E:/OneDrive - Virginia Tech/x_code/ddn/experiment_iddn_R/iddnSim/example/sim_jgl_speed_sample.R")
